language: node_js
node_js:
  - node
branches:
  only:
    - master
    - develop

stages:
  - build
  - test
  - name: deploy
    if: branch = master AND type != pull_request

jobs:
  include:
    - name: 'Building'
      stage: build
      script: npm run build
      node_js: node
    - name: 'Linting'
      stage: test
      script: npm run lint
    - name: 'CodeChecks'
      stage: test
      script: npx codechecks
    - name: 'Unit Tests'
      stage: test
      script: npm run test
      node_js: node
    - stage: deploy
      node_js: lts/*
      name: Deploy
      script: npm run build
      deploy:
        provider: script
        skip_cleanup: true
        script: npx multi-semantic-release

cache: npm
